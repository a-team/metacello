%html
  %head
    %title Metacello Community Page
    %meta{:charset => "utf-8"}/
    %meta{:"http-equiv" => "X-UA-Compatible", :content => "chrome=1"}/
    %script{:type => "text/javascript", :src =>"http://yandex.st/jquery/1.4.2/jquery.min.js"}
    %script{:type => "text/javascript", :src =>"/javascript/metacello.js"}
    %link{:href =>"/stylesheets/screen.css", :media =>"screen", :rel => "stylesheet", :type => "text/css"}/
    /[if IE]
      %script{:type => "text/javascript", :src =>"http://ajax.googleapis.com/ajax/libs/chrome-frame/1/CFInstall.min.js"}
      :javascript
        CFInstall.check({
          preventPrompt: true,
          onmissing: function() { window.location = "http://www.google.com/chromeframe/eula.html" }
        });
  %body
    #info-header
      -if flash.has?(:error)
        .error= flash[:error]
      -if flash.has?(:notice)
        .notice= flash[:notice]
    #header
      .logo
      .avatar
        -if current_user?
          %img{:href => "http://www.gravatar.com", :src => gravatar(current_user['mail'])}
          %a{:href => "#", :onclick => "toggle_form('account');"} Account
          %a{:href => "/logout"} Logout
          .account_form= haml :"forms/account", :locals => {:user => user}, :layout => false
        -else
          %a{:href => "#", :onclick => "toggle_form('login');"} Login/Signup
          .login_form= haml :"forms/login", :layout => false
      .search
        %form
          %label{:for => "search"} Search:
          %input{:name => "search"}
    #container
      = yield
